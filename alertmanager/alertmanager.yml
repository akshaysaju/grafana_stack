# Alertmanager Configuration
# Official Prometheus Alertmanager documentation: https://prometheus.io/docs/alerting/latest/configuration/

global:
  resolve_timeout: 5m

# Route configuration - defines how alerts are routed to receivers
route:
  receiver: "webhook-default"
  group_by: ["alertname", "job", "severity"]
  group_wait: 10s # Wait 10s to batch similar alerts
  group_interval: 5m # Wait 5m before sending next batch of grouped alerts
  repeat_interval: 1h # Resend critical alerts every 1 hour if still firing

  # Route critical alerts to webhook
  routes:
    - match:
        severity: critical
      receiver: "webhook-critical"
      repeat_interval: 1h

# Receivers - define notification destinations
receivers:
  # Default receiver for all other alerts
  - name: "webhook-default"
    webhook_configs:
      - url: "http://alert-notifier:9000/alerts"
        send_resolved: true
      - url: "https://webhook.site/b60de606-d461-4fdf-8246-af506ca8c2eb"
        send_resolved: true

  # Critical alerts receiver
  - name: "webhook-critical"
    webhook_configs:
      - url: "http://alert-notifier:9000/alerts"
        send_resolved: true
      - url: "https://webhook.site/b60de606-d461-4fdf-8246-af506ca8c2eb"
        send_resolved: true
